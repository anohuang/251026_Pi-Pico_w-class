# Streamlit MQTT 監控儀表板 - 產品需求文檔 (PRD)

## 專案概述

建立一個基於 Streamlit 的即時監控儀表板應用程式，透過 MQTT 協議訂閱並視覺化顯示智慧家居感測器數據。

## 系統角色

- **應用程式角色**：MQTT 訂閱者 (Subscriber)
- **資料來源**：透過 MQTT Broker 接收感測器數據
- **資料格式**：JSON 格式的感測器讀數

## 功能需求

### 1. 即時數據顯示

#### 1.1 電燈狀態監控
- **功能**：即時顯示客廳電燈的開關狀態
- **顯示方式**：視覺化指示器（例如：開/關按鈕樣式、LED 燈號、或狀態文字）
- **更新頻率**：即時更新（當收到 MQTT 訊息時立即更新）

#### 1.2 環境感測數據顯示
- **溫度監控**：顯示客廳當前溫度值（單位：攝氏度 °C）
- **濕度監控**：顯示客廳當前濕度值（單位：百分比 %）
- **顯示格式**：數值顯示，建議使用大號字體或卡片式設計

### 2. 數據視覺化

#### 2.1 溫濕度趨勢圖表
- **圖表類型**：折線圖 (Line Chart)
- **數據系列**：
  - 溫度曲線（建議使用紅色或藍色）
  - 濕度曲線（建議使用綠色或藍色）
- **X 軸**：日期和時間（格式：YYYY-MM-DD HH:MM:SS）
- **Y 軸**：
  - 左側：溫度（°C）
  - 右側：濕度（%）
- **圖表特性**：
  - 即時更新（隨新數據自動延伸）
  - 顯示數據點標記
  - 可選：顯示網格線以提高可讀性

### 3. 數據儲存功能

#### 3.1 Excel 檔案儲存
- **儲存時機**：每當收到新的 MQTT 訂閱訊息時，自動將數據追加到 Excel 檔案
- **檔案格式**：`.xlsx` (Excel 格式)
- **檔案結構**：
  - **欄位**：時間戳記、電燈狀態、溫度、濕度
  - **檔案命名**：建議使用日期命名（例如：`sensor_data_2025-11-30.xlsx`）
  - **儲存位置**：專案目錄下的 `data/` 資料夾

## 技術規格

### 3.1 MQTT 訂閱設定
- **Broker 地址**：localhost（或可配置）
- **端口**：1883
- **訂閱主題**：
  - `客廳/電燈` - 電燈開關狀態
  - `客廳/溫度` - 溫度數據
  - `客廳/濕度` - 濕度數據
  - 或統一主題：`客廳/感測器`（包含所有數據的 JSON）

### 3.2 資料格式範例
```json
{
  "device": "客廳感測器",
  "timestamp": "2025-11-30 14:30:00",
  "light_status": "on",
  "temperature": 25.5,
  "humidity": 60.0
}
```

### 3.3 依賴套件
- `streamlit` - Web 應用程式框架
- `paho-mqtt` - MQTT 客戶端
- `pandas` - 數據處理
- `openpyxl` 或 `xlsxwriter` - Excel 檔案操作
- `plotly` 或 `matplotlib` - 圖表繪製（建議使用 plotly 以獲得更好的互動性）

## 使用者介面設計

### 4.1 版面配置
- **頂部**：應用程式標題和說明
- **左側欄**：即時狀態顯示（電燈狀態、當前溫度、當前濕度）
- **主區域**：溫濕度趨勢圖表
- **底部**：數據儲存狀態提示

### 4.2 互動功能
- **僅顯示模式**：此版本為唯讀模式，不包含控制功能
- **自動刷新**：頁面自動更新以顯示最新數據
- **數據歷史**：圖表顯示歷史數據趨勢

## 未來擴充功能（非本次需求）
- 數據匯出功能（手動觸發）
- 數據篩選和查詢
- 警報通知（溫度/濕度超出範圍）
- 多房間監控支援